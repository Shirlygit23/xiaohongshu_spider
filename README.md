# 小红书数据分析工具

## 项目简介
本工具用于分析小红书笔记标题、图片和内容，帮助内容创作者了解内容规律和爆款特征。

## 主要功能

### 1. 标题相似度分析
- 分析标题关键词出现频率
- 按关键词对标题进行分组
- 展示每个关键词的相关标题示例
- 输出格式化的Excel分析报告

### 2. 爆款标题模板分析
- 识别点赞数 >= 1000 的爆款标题
- 分析标题模板类型（如：紧迫感、数字清单、强烈情感等）
- 提取爆款标题共性词组
- 生成可复用的标题模板库

### 3. 低粉爆款分析
- 识别点赞数>粉丝数且点赞数>100的笔记
- 保留原始数据的完整信息
- 按点赞数降序排序展示

### 4. 封面图片下载
- 低粉高互动封面下载
  * 筛选粉丝数 < 1000 且互动量 > 100 的笔记
  * 自动下载封面图片
  * 按指定格式保存
- 爆文封面下载
  * 筛选点赞数 > 1000 的笔记
  * 批量下载封面图片
  * 自动创建分类文件夹

### 5. 话题分析
- 提取笔记关键词标签
- 统计话题出现频率
- 分析话题互动数据
  * 总互动量统计
  * 平均互动量计算
  * 最高/最低互动量记录
- 输出Top 50话题分析报告

### 6. 笔记内容处理
- 自动获取笔记详情
  * 提取笔记正文内容
  * 排除话题标签内容
  * 保持原文格式
- 提取笔记话题标签
  * 识别所有话题标签
  * 按逗号分隔保存
  * 支持多话题处理
- 数据导出Excel
  * 保留原有数据列
  * 新增详情和话题列
  * 自动命名和保存

## 环境要求
- Python 3.6+
- 依赖包：pandas, openpyxl, jieba, matplotlib, wordcloud, requests, beautifulsoup4

## 安装依赖
bash
pip install -r requirements.txt

## 使用说明
1. 准备数据文件（Excel格式，必须包含所需字段）
2. 运行分析脚本：
bash
python src/title_analyzer.py # 标题分析
python src/image_downloader.py # 图片下载
python src/topic_analyzer.py # 话题分析
python src/note_processor.py # 笔记处理

## 核心知识点

### 1. 基础概念
- 变量和数据类型（str, int, list, dict, bool）
- 文件操作（os.path, Excel读写）
- 字符串处理（格式化、正则表达式）

### 2. 面向对象编程
- 类的定义和初始化
- 类的属性和方法
- 数据封装和处理

### 3. 数据处理
- DataFrame操作（pandas）
- 数据过滤和排序
- 统计分析（Counter）

### 4. 算法思维
- 分词和关键词提取
- 模式匹配和相似度计算
- 数据聚类和分类

### 5. 网络编程
- HTTP请求处理
- 请求头管理
- 超时和异常处理

### 6. 并发编程
- 线程池使用
- 并发下载控制
- 资源管理

### 7. 文件操作
- 文件夹创建和管理
- 图片文件保存
- 路径处理

### 8. Excel处理
- 表格创建和格式化
- 数据写入和样式设置
- 自动列宽调整

### 9. 数据统计分析
- 频率统计
- 数据聚合
- 多维度分析
- 排序和筛选

### 10. 网页内容提取
- HTML解析
- 元素定位
- 文本处理
- 内容过滤

### 11. 网络请求处理
- Cookie管理
- 请求头设置
- 超时控制
- 错误处理

## 开发经验总结

### 主要更新历程
1. 优化了低粉爆款文件名格式
2. 添加了共性词提取功能
3. 改进了数据对齐和自动换行设置
4. 优化了表格布局和显示效果
5. 添加了图片下载功能
6. 实现了并发下载优化
7. 添加了话题分析功能
8. 实现了笔记内容提取

### 遇到的问题及解决方案
1. 合并单元格处理问题
   - 问题：处理合并单元格时出现 AttributeError
   - 解决：使用 openpyxl.utils.get_column_letter

2. 共性词提取效果问题
   - 问题：提取的共性词可能不够相关
   - 解决：添加关键词过滤和频率阈值

3. 网络请求问题
   - 问题：请求可能被拦截或超时
   - 解决：添加请求头和超时设置

### 后续迭代建议
1. 数据源适配
   - 支持更多数据源格式
   - 添加数据预处理功能

2. 分析维度扩展
   - 添加更多标题模板类型
   - 增加时间维度分析
   - 添加行业特征分析

3. 图片下载优化
   - 添加图片质量检测
   - 支持断点续传
   - 添加重试机制

4. 性能优化
   - 优化大数据量处理
   - 添加缓存机制
   - 优化并发策略

5. 话题分析优化
   - 添加话题关联分析
   - 实现话题趋势分析
   - 添加数据可视化
   - 支持自定义分析维度
   - 添加话题分类功能

6. 笔记处理优化
   - 支持批量处理
   - 添加断点续传
   - 优化请求策略
   - 增加数据验证
   - 支持更多内容类型

## 注意事项
1. 数据格式要求：
   - Excel文件必须包含必需列
   - 注意数据完整性

2. 网络请求注意：
   - 控制请求频率
   - 注意网络稳定性
   - 考虑代理使用

3. 资源管理：
   - 及时释放资源
   - 控制并发数量
   - 注意磁盘空间

4. 话题分析注意事项：
   - 注意数据完整性检查
   - 关注异常值处理
   - 考虑性能优化
   - 保持结果可读性
   - 预留扩展空间

5. 笔记处理注意事项：
   - 及时更新Cookie
   - 控制请求频率
   - 注意内容完整性
   - 处理异常情况
   - 遵守平台规则

## 未来开发方向建议

### 1. 数据分析扩展
- 添加更多维度的数据分析
  * 时间维度分析
  * 用户画像分析
  * 内容主题分析
- 增加数据可视化功能
  * 趋势图表
  * 分布统计
  * 相关性分析

### 2. 爬虫功能
- 实现自动化数据采集
  * 定时采集
  * 多账号支持
  * 代理池管理
- 添加更多数据源支持
  * 其他社交平台
  * 多媒体内容

### 3. 用户界面
- 开发简单的GUI界面
  * 参数配置界面
  * 实时进度显示
  * 结果预览窗口
- 添加交互式操作
  * 拖拽功能
  * 快捷操作
  * 批量处理

### 4. 报告生成
- 生成分析报告PDF
  * 自定义模板
  * 多种格式支持
  * 图文混排
- 添加更多数据图表
  * 高级统计图表
  * 动态图表
  * 交互式图表

### 5. 系统优化
- 性能优化
  * 并发处理
  * 缓存机制
  * 资源管理
- 稳定性提升
  * 异常处理
  * 日志系统
  * 监控告警

## 贡献指南
欢迎提交Issue和Pull Request来帮助改进项目。

## 许可证
MIT License